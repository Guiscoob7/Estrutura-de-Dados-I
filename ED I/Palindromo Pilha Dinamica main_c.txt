#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "funcoes.h"

int main() {
    pilhaDinamica* pilha;  // Ponteiro para a pilha dinÃ¢mica ğŸŒŸ
    char frase[100];  // Vetor para armazenar a frase do usuÃ¡rio âœï¸
    char nomeDepois[26];  // Vetor para armazenar a palavra revertida ğŸ”„
    char* token;  // Ponteiro para armazenar cada palavra tokenizada ğŸ·ï¸

    // Criando a pilha dinÃ¢mica ğŸ“¦
    pilha = criarPilhaDinamica();  // Use a funÃ§Ã£o para criar a pilha dinÃ¢mica
    if (pilha == NULL) {
        printf(RED "Erro ao criar a pilha. âŒ\n" RESET);  // Mensagem de erro se a pilha nÃ£o for criada âš ï¸
        return 1;  // Sai do programa se houver erro ao criar a pilha ğŸšª
    }

    // Exibe mensagem de boas-vindas ğŸ‘‹
    boasVindas();

    // Captura a frase do usuÃ¡rio ğŸ—£ï¸
    printf(GREEN "Digite uma frase: " RESET);  // Mensagem para o usuÃ¡rio ğŸ’¬
    scanf("%99[^\n]", frase);  // Captura a frase ğŸ“œ
    limparbuffer();  // Limpa o buffer de entrada ğŸ§¹
    limpar();  // Limpa a tela ğŸ”

    // Tokeniza a frase em palavras usando o delimitador espaÃ§o " "
    token = strtok(frase, " ");
    
    // Processa cada token enquanto houver palavras
    while (token != NULL) {
        substituirCaracteresEspeciais(token);  // Substitui caracteres especiais na palavra
        // Verifica se o token Ã© palÃ­ndromo
        if (processarToken(pilha, token, nomeDepois)) {  
            printf(CYAN "\n\nâœ¨ PalÃ­ndromo! ğŸ‰âœ¨\n\nAntes: " BOLD GREEN "%s" RESET "\n" BOLD YELLOW "Depois: " RESET LIGHT_YELLOW "%s\n\n" RESET, token, nomeDepois);
        } else {
            printf(MAGENTA "\n\nğŸš« NÃ£o Ã© palÃ­ndromo! âŒ\n\nAntes: " BOLD LIGHT_BLUE "%s" RESET "\n" BOLD RED "Depois: " RESET LIGHT_RED "%s\n\n" RESET, token, nomeDepois);
        }
        limpar();
        token = strtok(NULL, " ");  // Pega a prÃ³xima palavra
    }

    // Libera a memÃ³ria da pilha ğŸ§ 
    liberarPilhaDinamica(pilha);  // Libera a memÃ³ria alocada para a pilha ğŸ’»

    // Mensagem de agradecimento ao usuÃ¡rio
    printf(YELLOW "\nğŸŒˆ Obrigado por usar o programa! AtÃ© mais! ğŸŒˆ\n\n" RESET);  // Mensagem de agradecimento ğŸ™
    
    return 0;  // Finaliza o programa com sucesso ğŸŠ
}